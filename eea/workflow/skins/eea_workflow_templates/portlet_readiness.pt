<html xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  i18n:domain="indicators">

  <body>
    <metal:macro metal:define-macro="portlet">
      <tal:defs tal:define="api nocall:context/@@get_readiness | nothing; 
        has_permission python:context.portal_membership.checkPermission('Modify portal content', context)" 
        tal:condition="python:api and has_permission" >
        <dl class="portlet" id="readiness-status" 
          tal:define="info python:api.get_info_for('published');
          extra info/extra">
          <dt class="portletHeader">
            <a href="" 
              tal:attributes="href string:${context/absolute_url}/edit" 
              class="tile">Editing progress</a>
          </dt>

          <dt class="portletItem percentageDone">
            <span tal:content="info/rfs_done" class="percentage" />% percentage done.
          </dt>

          <dt class="portletItem missingRequired">
            <span class="missingRequiredNr" tal:content="python:info['rfs_required'] - info['rfs_with_value']" /> 
            of 
            <span tal:content="python:info['rfs_required']" /> 
            required fields are missing. 
          </dt>

          <dt class="portletItem missingFields" tal:condition="info/rfs_field_names">
            <ul>
              <li tal:repeat="field info/rfs_field_names" >
                <a href="#rfs_title" tal:attributes="href string:@@edit_aggregated#rfs_${name}" 
                  tal:content="label" tal:define="name python:field[0]; label python:field[1]">Field</a>
              </li>
            </ul>
          </dt>

          <dt class="portletItem discreet">
            There are <span tal:content="info/total_fields" /> fields in this content item.
          </dt>

          <dt class="portletItem extra" tal:condition="extra">
            <tal:rep repeat="entry info/extra">
              <div tal:attributes="class python:entry[0]" 
                tal:content="python:entry[1]">Something here</div> 
            </tal:rep>
          </dt>

          <dd class="portletFooter">
            <a href="" 
              tal:attributes="href string:${context/absolute_url}/edit" 
              title="" class="moreLink" >
              <span i18n:translate="edit">Edit</span>
            </a>
          </dd>
        </dl>
      </tal:defs>
    </metal:macro>
  </body>
</html>
